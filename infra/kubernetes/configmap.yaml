apiVersion: v1
kind: ConfigMap
metadata:
  name: ventro-config
  namespace: ventro
  labels:
    app.kubernetes.io/name: ventro
data:
  APP_ENV: "production"
  APP_NAME: "Ventro"
  APP_VERSION: "1.0.0"
  DEBUG: "false"
  API_HOST: "0.0.0.0"
  API_PORT: "8000"
  API_WORKERS: "4"

  # Cluster-internal service URLs (non-sensitive)
  REDIS_URL: "redis://ventro-redis:6379/0"
  CELERY_BROKER_URL: "redis://ventro-redis:6379/1"
  CELERY_RESULT_BACKEND: "redis://ventro-redis:6379/2"
  QDRANT_HOST: "ventro-qdrant"
  QDRANT_PORT: "6333"
  QDRANT_COLLECTION_NAME: "ventro_docs"
  OLLAMA_BASE_URL: "http://ventro-ollama:11434"
  LANGFUSE_HOST: "http://ventro-langfuse:3000"
  LANGFUSE_ENABLED: "false"

  # Model config
  OLLAMA_PRIMARY_MODEL: "qwen2.5:7b-instruct"
  EMBEDDING_MODEL: "intfloat/multilingual-e5-large-instruct"
  EMBEDDING_DIMENSION: "1024"
  GROQ_MODEL: "llama-3.3-70b-versatile"

  # Rate limiting
  RATE_LIMIT_STRATEGY: "per_user"
  RATE_LIMIT_WINDOW_SECONDS: "60"
  RATE_LIMIT_AUTH_REQUESTS: "10"
  RATE_LIMIT_API_REQUESTS: "120"
  RATE_LIMIT_UPLOAD_REQUESTS: "20"
  RATE_LIMIT_BURST_MULTIPLIER: "1.5"
  RATE_LIMIT_ENABLED: "true"

  # JWT
  JWT_ALGORITHM: "HS256"
  JWT_ACCESS_TOKEN_EXPIRE_MINUTES: "60"
  JWT_REFRESH_TOKEN_EXPIRE_DAYS: "7"

  # Upload
  MAX_UPLOAD_SIZE_MB: "50"
  TEMP_UPLOAD_DIR: "/tmp/ventro_uploads"

  # SAMR
  SAMR_ENABLED: "true"
  SAMR_DIVERGENCE_THRESHOLD: "0.85"

  # Secrets provider (pulls real secrets from Vault at boot)
  SECRETS_PROVIDER: "vault"
  VAULT_SECRET_PATH: "secret/data/ventro/production"

  # Encryption
  ENCRYPTION_ENABLED: "true"

  # LLM fallback
  LLM_FALLBACK_CHAIN: '["groq", "ollama", "rule_based"]'
  LLM_PROVIDER_TIMEOUT_SECONDS: "45"
  LLM_MAX_FAILURES_BEFORE_CIRCUIT_BREAK: "3"
  LLM_CIRCUIT_BREAK_RECOVERY_SECONDS: "60"
